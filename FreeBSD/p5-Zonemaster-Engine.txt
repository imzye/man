Zonemaster::Engine(3)                      User Contributed Perl Documentation


NAME
       Zonemaster::Engine - A tool to check the quality of a DNS zone

SYNOPSIS
           my @results = Zonemaster::Engine->test_zone('iis.se')

INTRODUCTION
       This manual describes the main Zonemaster::Engine module. If what
       you're after is documentation on the Zonemaster test engine as a whole,
       see Zonemaster::Engine::Overview.

METHODS
       init_engine()
           Run the initialization tasks if they have not been run already.
           This method is called automatically in INIT block.

       test_zone($name)
           Runs all available tests and returns a list of
           Zonemaster::Engine::Logger::Entry objects.

       test_module($module, $name)
           Runs all available tests for the zone with the given name in the
           specified module.

       test_method($module, $method, $name)
           Run one particular test method in one particular module for one
           particular zone.  The requested module must be in the list of
           currently enabled modules (that is, not a module disabled by the
           current profile), and the method must be listed in the metadata of
           the module exports.  If those requirements are fulfilled, the
           method will be called with the provided arguments.

       zone($name)
           Returns a Zonemaster::Engine::Zone object for the given name.

       ns($name, $address)
           Returns a Zonemaster::Engine::Nameserver object for the given name
           and address.

       profile()
           Returns the effective profile (Zonemaster::Engine::Profile object).

       logger()
           Returns the global Zonemaster::Engine::Logger object.

       all_tags()
           Returns a list of all the tags that can be logged for all available
           test modules.

       all_methods()
           Returns a hash, where the keys are test module names and the values
           are lists with the names of the test methods in that module.

       recurse($name, $type, $class)
           Does a recursive lookup for the given name, type and class, and
           returns the resulting packet (if any). Simply calls "recurse" in
           Zonemaster::Engine::Recursor on a globally stored object.

       can_continue()
           In case of critical condition that prevents tool to process tests,
           add test here and return False.

       save_cache($filename)
           After running the tests, save the accumulated cache to a file with
           the given name.

       preload_cache($filename)
           Before running the tests, load the cache with information from a
           file with the given name. This file must have the same format as is
           produced by "save_cache()".

       asn_lookup($ip)
           Takes a single IP address (string or Net::IP::XS object) and
           returns a list of AS numbers, if any.

       modules()
           Returns a list of the loaded test modules. Exactly the same as
           "modules" in Zonemaster::Engine::Test.

       add_fake_delegation($domain, $data, %flags)
           This method adds some fake delegation information to the system.

           The arguments are a domain name, and a hashref with delegation
           information.  The keys in the hash are nameserver names, and the
           values are arrayrefs of IP addresses for their corresponding
           nameserver.  Alternatively the IP addresses may be specified as an
           `undef` which is handled the same as an empty arrayref.

           For each provided nameserver with an empty list of addresses,
           either a "FAKE_DELEGATION_NO_IP" or a
           "FAKE_DELEGATION_IN_ZONE_NO_IP" message is emitted.

           The only recognized flag is "fill_in_empty_oob_glue".  This flag is
           boolean and defaults to true.  If this flag is true, this method
           updates the given $data by looking up and filling in some glue
           addresses.  Specifically the glue addresses for any nameserver name
           that are out-of-bailiwick of the given $domain and that comes with
           an empty list of addresses.

           Returns `1` if all name servers in $data have non-empty lists of
           glue (after they've been filled in) or if `fill_in_empty_oob_glue`
           is false.  Otherwise it returns `undef`.

           Examples:

               Zonemaster::Engine->add_fake_delegation(
                   'lysator.liu.se' => {
                       'ns1.nic.fr' => [ ],
                       'ns.nic.se'  => [ '212.247.7.228',  '2a00:801:f0:53::53' ],
                       'i.ns.se'    => [ '194.146.106.22', '2001:67c:1010:5::53' ],
                       'ns3.nic.se' => [ '212.247.8.152',  '2a00:801:f0:211::152' ]
                   },
               );

           returns 1.

               Zonemaster::Engine->add_fake_delegation(
                   'lysator.liu.se' => {
                       'ns1.lysator.liu.se' => [ ],
                       'ns.nic.se'  => [ '212.247.7.228',  '2a00:801:f0:53::53' ],
                       'i.ns.se'    => [ '194.146.106.22', '2001:67c:1010:5::53' ],
                       'ns3.nic.se' => [ '212.247.8.152',  '2a00:801:f0:211::152' ]
                   }
               );

           returns "undef" (signalling that fake delegation with empty glue
           was added to the system).

               Zonemaster::Engine->add_fake_delegation(
                   'lysator.liu.se' => {
                       'ns1.nic.fr' => [ ],
                       'ns.nic.se'  => [ '212.247.7.228',  '2a00:801:f0:53::53' ],
                       'i.ns.se'    => [ '194.146.106.22', '2001:67c:1010:5::53' ],
                       'ns3.nic.se' => [ '212.247.8.152',  '2a00:801:f0:211::152' ]
                   },
                   fill_in_empty_oob_glue => 0,
               );

           returns 1. It does not even attempt to fill in glue for ns1.nic.fr.

       add_fake_ds($domain, $data)
           This method adds fake DS records to the system. The arguments are a
           domain name, and a reference to a list of references to hashes. The
           hashes in turn must have the keys "keytag", "algorithm", "type" and
           "digest", with the values holding the corresponding data. The
           digest data should be a single unbroken string of hexadecimal
           digits.

           Example:

              Zonemaster::Engine->add_fake_ds(
                 'nic.se' => [
                    { keytag => 16696, algorithm => 5, type => 2, digest => '40079DDF8D09E7F10BB248A69B6630478A28EF969DDE399F95BC3B39F8CBACD7' },
                    { keytag => 16696, algorithm => 5, type => 1, digest => 'EF5D421412A5EAF1230071AFFD4F585E3B2B1A60' },
                 ]
              );

       start_time_now()
           Set the logger's start time to the current time.

       reset()
           Reset logger start time to current time, empty the list of log
           messages, clear nameserver object cache and recursor cache.

AUTHORS
       Vincent Levigneron <vincent.levigneron at nic.fr> - Current maintainer

       Calle Dybedahl <calle at init.se> - Original author

LICENSE
       This is free software under a 2-clause BSD license. The full text of
       the license can be found in the LICENSE file included with this
       distribution.

perl v5.40.2                      2025-03-04             Zonemaster::Engine(3)
