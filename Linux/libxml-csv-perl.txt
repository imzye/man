CSV(3pm)                                                                            User Contributed Perl Documentation                                                                            CSV(3pm)

NAME
       XML::CSV - Perl extension converting CSV files to XML

SYNOPSIS
         use XML::CSV;
         $csv_obj = XML::CSV->new();
         $csv_obj = XML::CSV->new(\%attr);

         $status = $csv_obj->parse_doc(file_name);
         $status = $csv_obj->parse_doc(file_name, \%attr);

         $csv_obj->declare_xml(\%attr);
         $csv_obj->declare_doctype(\%attr);

         $csv_obj->print_xml(file_name, \%attr);

DESCRIPTION
       XML::CSV is a new module in is going to be upgraded very often as my time permits.  For the time being it uses CSV_XS module object default values to parse the (*.csv) document and then creates a
       perl data structure with xml tags names and data.  At this point it does not allow for a write as you parse interface but is the first upgrade for the next release.  I will also allow more access
       to the data structures and more documentation.  I will also put in more support for XML, since currently it only allows a simple XML structure.  Currently you can modify the tag structure to allow
       for attributes.  No DTD support is currently available, but will be implemented in a soon coming release.  As the module will provide both: object and event interfaces, it will be used upon
       individual needs, system resources, and required performance.  Ofcourse the DOM implementation takes up more resources and in some instances timing, it's the easiest to use.

ATTRIBUTES new()
       error_out - Turn on the error handling which will die on all errors and assign the error message to $XML::CSV::csvxml_error.

       column_headings - Specifies the column heading to use.  Passed as an array reference.  Can be used as a supplement to using the first column in the file as the XML tag names.  Since XML::CSV does
       not require you to parse the CSV file, you can provide your own data structure to parse.

       column_data - Specifies the CSV data in a two dimensional array.  Passed as an array reference.

       csv_xs - Specifies the CSV_XS object to use.  This is used to create custom CSV_XS object and override the default one created by XML::CSV.

ATTRIBUTES parse_doc()
       headings - Specifies the number of rows to use as tag names.  Defaults to 0.  Ex.  {headings => 1} (This will use the first row of data as xml tags)

       sub_char - Specifies the character with which the illegal tag characters will be replaced with.  Defaults to undef meaning no substitution is done.  To eliminate characters use "" (empty string)
       or to replace with another see below.  Ex.  {sub_char => "_"} or {sub_char => ""}

ATTRIBUTES declare_xml()
       version - Specifies the xml version.  Ex.  {version => '1.0'}

       encoding - Specifies the type of encoding.  XML standard defaults encoding to 'UTF-8' if notspecifically
                  set.  Ex.  {encoding => 'ISO-8859_1'}

       standalone - Specifies the the document as standalone (yes|no).  If the document is does not rely on an
                    external DTD, DTD is internal, or the external DTD does not effect the contents of the document,
                    the standalone attribute should be set to 'yes', otherwise 'no' should be used.  For more info
                    see XML declaration documentation.  Ex.  {standalone => 'yes'}

ATTRIBUTES declare_doctype()
       source - Specifies the source of the DTD (SYSTEM|PUBLIC) Ex. {source => 'SYSTEM'}

       location1 - URI to the DTD file.  Public ID may be used if source is PUBLIC.  Ex. {location1 => 'http://www.xmlproj.com/dtd/index_dtd.dtd'} or {location1 => '-//Netscape Communications//DTD RSS
       0.90//EN'}

       location2 - Optional second URI.  Usually used if the location1 public ID is not found by the
                   validating parser.  Ex. {location2 => 'http://www.xmlproj.com/file.dtd'}

       subset - Any other information that proceedes the DTD declaration.  Usually includes internal DTD if any.  Ex. {subset => 'ELEMENT first_name (#PCDATA)>\n<!ELEMENT last_name (#PCDATA)>'} You can
       even enterpolate the string with $obj->{column_headings} to dynamically build the DTD.  Ex. {subset => "ELEMENT $obj->{columnt_headings}[0] (#PCDATA)>"}

ATTRIBUTES print_xml()
       file_tag - Specifies the file parent tag.  Defaults to "records".  Ex. {file_tag => "file_data"} (Do not use < and > when specifying)

       parent_tag - Specifies the record parent tag.  Defaults to "record".  Ex. {parent_tag => "record_data"} (Do not use < and > when specifying)

       format - Specifies the character to use to indent nodes.  Defaults to "\t" (tab).  Ex. {format => " "} or {format => "\t\t"}

PUBLIC VARIABLES
       $csv_obj->{column_headings} $csv_obj->{column_data}

EXAMPLES
       Example #1:

       This is a simple implementation which uses defaults

       use XML::CSV; $csv_obj = XML::CSV->new(); $csv_obj->parse_doc("in_file.csv", {headings => 1});

       $csv_obj->print_xml("out.xml");

       Example #2:

       This example uses a passed headings array reference which is used along with the parsed data.

       use XML::CSV; $csv_obj = XML::CSV->new();

       $csv_obj->{column_headings} = \@arr_of_headings;

       $csv_obj->parse_doc("in_file.csv"); $csv_obj->print_xml("out.xml", {format => " ", file_tag = "xml_file", parent_tag => "record"});

       Example #3:

       First it passes a reference to a array with column headings and then a reference to two dimensional array of data where the first index represents the row number and the second column number.  We
       also pass a custom Text::CSV_XS object to overwrite the default object.  This is useful for creating your own CSV_XS object's args before using the parse_doc() method.  See 'perldoc Text::CSV_XS'
       for different new() attributes.

       use XML::CSV;

       $default_obj_xs = Text::CSV_XS->new({quote_char => '"'}); $csv_obj = XML::CSV->new({csv_xs => $default_obj_xs}); $csv_obj->{column_headings} = \@arr_of_headings;

       $csv_obj->{column_data} = \@arr_of_data;

       $csv_obj->print_xml("out.xml");

AUTHOR
       Ilya Sterin, isterin@mail.com

SEE ALSO
       Text::CSV_XS

perl v5.34.0                                                                                     2022-05-27                                                                                        CSV(3pm)
