UVES_CAL_RESPONSE(7)                                                                         uves recipes                                                                         UVES_CAL_RESPONSE(7)

NAME
       uves_cal_response - Determines response function and quantum efficiency

SYNOPSIS
       esorex uves_cal_response [OPTIONS] FILE.sof

DESCRIPTION
       This recipe reduces a standard star frame (STANDARD_xxx or STANDARD_xxx, where xxx = BLUE, RED) using a combination (depending on recipe parameters and provided input frames) of the steps:
         - bias subtraction,
         - dark subtraction,
         - background subtraction,
         - extraction/cosmic ray removal,
         - flat-field correction,
         - wavelength rebinning,
         - sky subtraction,
         - order merging.

        Expected input for this recipe is an raw std star frame, STANDARD_xxx or order table(s) for each chip, ORDER_TABLE_xxxx (where xxxx=BLUE, REDL, REDU), line table(s) for each chip, LINE_TA‐
       BLE_xxxx, a master bias frame, MASTER_BIAS_xxxx, a master flat, MASTER_FLAT_xxxx, a reference standard star flux table, FLUX_STD_TABLE, a table describing the atmospheric extintion, EXTCO‐
       EFF_TABLE, and the catalog indicating points to fit the response, RESP_FIT_POINTS_CATALOG.

       Two reductions are performed, the first using optimal extraction (used to compute the instrument response function), the second using linear extraction (used to get the Quantum Detection Ef‐
       ficiency)

       For each chip (xxxx = BLUE, REDL, REDU) the recipe produces
         INSTR_RESPONSE_FINE_xxxx          Response curve
         RED_STD_xxxx                 Reduced spectrum
         EFFICIENCY_TABLE_xxxx        Efficiency table
         BKG_STD_xxxx                 The subtracted background

OPTIONS
       --debug <bool>
              Whether or not to save intermediate results to local directory (bool; default: False). The full name of this option for the EsoRex configuration file is uves.debug [default = False].

       --efficiency.reduce.best <bool>
              (optimal  extraction  only)  If false (fastest), the spectrum is extracted only once. If true (best), the spectrum is extracted twice, the second time using improved variance estimates
              based on the first iteration. Better variance estimates slightly improve the obtained signal to noise but at the cost of increased execution time (bool; default: True). The  full  name
              of this option for the EsoRex configuration file is uves_cal_response.efficiency.reduce.best [default = True].

       --efficiency.reduce.extract.method <str>
              Extraction  method. <average | linear | weighted | optimal> (str; default: ´linear´). The full name of this option for the EsoRex configuration file is uves_cal_response.efficiency.re‐
              duce.extract.method [default = linear].

       --efficiency.reduce.ffmethod <str>
              Flat-fielding method. If set to ´pixel´, flat-fielding is done in pixel-pixel space (before extraction); if set to ´extract´, flat- fielding is performed in pixel-order space (i.e. af‐
              ter extraction). If set to ´no´, no flat-field correction is done, in which case reduce.rebin.scale should be set to true to ensure flux conservation (both  for  response  and  science
              data). <pixel | extract | no> (str; default: ´no´). The full name of this option for the EsoRex configuration file is uves_cal_response.efficiency.reduce.ffmethod [default = no].

       --efficiency.reduce.merge <str>
              Order  merging  method. If ´optimal´, the flux in the overlapping region is set to the (optimally computed, using the uncertainties) average of single order spectra. If ´sum´, the flux
              in the overlapping region is computed as the sum of the single order spectra.If ´noappend´ the spectrum is simply rebinned but not merged.If flat-fielding is done, method ´optimal´  is
              recommended,  otherwise  ´sum´.  <optimal  |  sum  | noappend> (str; default: ´sum´). The full name of this option for the EsoRex configuration file is uves_cal_response.efficiency.re‐
              duce.merge [default = sum].

       --paccuracy <float>
              The pointing accuracy (in arcseconds) used to identify the observed star with a catalogue star. If the angular separation is less than this number, the identification is made.  (float;
              default: 60.0). The full name of this option for the EsoRex configuration file is uves_cal_response.efficiency.paccuracy [default = 60.0].

       --plotter <str>
              Any  plots produced by the recipe are redirected to the command specified by this parameter. The plotting command must contain the substring ´gnuplot´ and must be able to parse gnuplot
              syntax on its standard input. Valid examples of such a command may include ´gnuplot -persist´ and ´cat > mygnuplot$$.gp´. A finer control of the plotting options  can  be  obtained  by
              writing an executable script, e.g.  my_gnuplot.pl, that executes gnuplot after setting the desired gnuplot options (e.g. set terminal pslatex color). To turn off plotting, set this pa‐
              rameter to ´no´ (str; default: ´no´). The full name of this option for the EsoRex configuration file is uves.plotter [default = no].

       --process_chip <str>
              For RED arm data process the redl, redu, or both chip(s) (str; default: ´both´). The full name of this option for the EsoRex configuration file is uves.process_chip [default = both].

       --reduce.backsub.mmethod <str>
              Background  measuring  method. If equal to ´median´ the background is sampled using the median of a subwindow. If ´minimum´, the subwindow minimum value is used. If ´no´, no background
              subtraction is done.  (str; default: ´median´). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.backsub.mmethod [default = median].

       --reduce.backsub.npoints <int>
              This is the number of columns in interorder space used to sample the background. (int; default: 82). The full name of this option for the  EsoRex  configuration  file  is  uves_cal_re‐
              sponse.reduce.backsub.npoints [default = 82].

       --reduce.backsub.radiusy <int>
              The height (in pixels) of the background sampling window is (2*radiusy + 1). This parameter is not corrected for binning. (int; default: 2). The full name of this option for the EsoRex
              configuration file is uves_cal_response.reduce.backsub.radiusy [default = 2].

       --reduce.backsub.sdegree <int>
              Degree  of  interpolating  splines.  Currently  only  degree = 1 is supported (int; default: 1). The full name of this option for the EsoRex configuration file is uves_cal_response.re‐
              duce.backsub.sdegree [default = 1].

       --reduce.backsub.smoothx <float>
              If spline interpolation is used to measure the background, the x-radius of the post-smoothing window is (smoothx * image_width).  Here, ´image_width´ is the image width after  binning.
              If  negative,  the default values are used: (25.0/4096) for blue flat-field frames, (50.0/4096) for red flat-field frames, (300.0/4096) for blue science frames and (300.0/4096) for red
              science frames. (float; default: -1.0). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.backsub.smoothx [default = -1.0].

       --reduce.backsub.smoothy <float>
              If spline interpolation is used to measure the background, the y-radius of the post-smoothing window is (smoothy * image_height).  Here, ´image_height´ is the image height  after  bin‐
              ning.  If  negative, the default values are used: (100.0/2048) for blue flat-field frames, (300.0/2048) for red flat-field frames, (200.0/2048) for blue science frames and (500.0/2048)
              for red science frames. (float; default: -1.0). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.backsub.smoothy [default = -1.0].

       --reduce.extract.best <bool>
              (optimal extraction only) If false (fastest), the spectrum is extracted only once. If true (best), the spectrum is extracted twice, the second time using  improved  variance  estimates
              based  on  the first iteration. Better variance estimates slightly improve the obtained signal to noise but at the cost of increased execution time (bool; default: True). The full name
              of this option for the EsoRex configuration file is uves_cal_response.reduce.extract.best [default = True].

       --reduce.extract.chunk <int>
              In optimal extraction mode, the chunk size (in pixels) used for fitting the analytical profile (a fit of the analytical profile to single bins would suffer from low statistics).  (int;
              default: 32). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.extract.chunk [default = 32].

       --reduce.extract.kappa <float>
              In optimal extraction mode, this is the threshold for bad (i.e.  hot/cold) pixel rejection. If a pixel deviates more than kappa*sigma (where sigma is the uncertainty of the pixel flux)
              from  the  inferred spatial profile, its weight is set to zero. Range: [-1,100]. If this parameter is negative, no rejection is performed. (float; default: 10.0). The full name of this
              option for the EsoRex configuration file is uves_cal_response.reduce.extract.kappa [default = 10.0].

       --reduce.extract.method <str>
              Extraction method. (2d/optimal not supported by uves_cal_wavecal, weighted supported only by uves_cal_wavecal, 2d not supported by uves_cal_response)  (str;  default:  ´optimal´).  The
              full name of this option for the EsoRex configuration file is uves_cal_response.reduce.extract.method [default = optimal].

       --reduce.extract.oversample <int>
              The oversampling factor used for the virtual resampling algorithm. If negative, the value 5 is used for S/N <=200, and the value 10 is used if the estimated S/N is > 200 (int; default:
              -1). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.extract.oversample [default = -1].

       --reduce.extract.profile <str>
              In  optimal extraction mode, the kind of profile to use. ´gauss´ gives a Gaussian profile, ´moffat´ gives a Moffat profile with beta=4 and a possible linear sky contribution. ´virtual´
              uses a virtual resampling algorithm (i.e. measures and uses the actual object profile).  ´constant´ assumes a constant spatial profile and allows optimal extraction of wavelength cali‐
              bration frames. ´auto´ will automatically select the best method based on the estimated S/N of the object. For low S/N, ´moffat´ or ´gauss´ are recommended (for robustness).  For  high
              S/N,  ´virtual´ is recommended (for accuracy). In the case of virtual resampling, a precise determination of the order positions is required; therefore the order-definition is repeated
              using the (assumed non-low S/N) science frame (str; default: ´auto´). The full name of this option for the EsoRex configuration file  is  uves_cal_response.reduce.extract.profile  [de‐
              fault = auto].

       --reduce.extract.skymethod <str>
              In  optimal extraction mode, the sky subtraction method to use.  ´median´ estimates the sky as the median of pixels along the slit (ignoring pixels close to the object), whereas ´opti‐
              mal´ does a chi square minimization along the slit to obtain the best combined object and sky levels. The optimal method gives the most accurate sky determination but  is  also  a  bit
              slower  than  the median method (str; default: ´optimal´). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.extract.skymethod [default = opti‐
              mal].

       --reduce.ffmethod <str>
              Flat-fielding method. If set to ´pixel´, flat-fielding is done in pixel-pixel space (before extraction); if set to ´extract´, flat- fielding is performed in pixel-order space (i.e. af‐
              ter extraction). If set to ´no´, no flat-field correction is done, in which case reduce.rebin.scale should be set to true to ensure flux conservation (both  for  response  and  science
              data) (str; default: ´extract´). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.ffmethod [default = extract].

       --reduce.merge <str>
              Order  merging  method. If ´optimal´, the flux in the overlapping region is set to the (optimally computed, using the uncertainties) average of single order spectra. If ´sum´, the flux
              in the overlapping region is computed as the sum of the single order spectra. If ´noappend´ the spectrum is simply rebinned but not merged.If flat-fielding is done, method ´optimal´ is
              recommended, otherwise ´sum´. (str; default: ´optimal´). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.merge [default = optimal].

       --reduce.merge_delt1 <float>
              Order merging left hand (short wavelength) cut. To reduce the amount of order overlapping regions we allow to cut short and long wavelength ranges. This may reduce the ripple  possibly
              introduced by the order merging. Suggested values are: 10 (W<=390), 12 (390<W<=437, 520<W<=564), 14 (437<W<=520, 564<W)  (float; default: 0.0). The full name of this option for the Es‐
              oRex configuration file is uves_cal_response.reduce.merge_delt1 [default = 0.0].

       --reduce.merge_delt2 <float>
              Order  merging right hand (long wavelength) cut. To reduce the amount of order overlapping regions we allow to cut short and long wavelength ranges. This may reduce the ripple possibly
              introduced by the order merging. Suggested values is 4 (float; default: 0.0). The full name of this option for the EsoRex  configuration  file  is  uves_cal_response.reduce.merge_delt2
              [default = 0.0].

       --reduce.objoffset <float>
              Offset  (in  pixels)  of extraction slit with respect to center of order.  For optimal extraction the full slit is offset. For linear/average extraction, reduce.objoffset is ignored if
              reduce.objslit [default -1.0] is negative. In this case the offset is automatically determined by measuring the actual object position. (float; default: 0.0). The full name of this op‐
              tion for the EsoRex configuration file is uves_cal_response.reduce.objoffset [default = 0.0].

       --reduce.objslit <float>
              Object window size (in pixels), ignored for optimal extraction. The value must be smaller than the total slit length. If negative, the default value (half of full slit length) is used.
              The upper and lower sky windows are defined as the part of the full slit (if any) outside the object window. The center of the object window is  determined  by  the  offset  parameter.
              (float; default: -1.0). The full name of this option for the EsoRex configuration file is uves_cal_response.reduce.objslit [default = -1.0].

       --reduce.rebin.scale <bool>
              Whether  or  not  to  multiply  by the factor dx/dlambda (pixels per wavelength) during the rebinning to conserve the flux. This option is disabled as default because applying the flat
              field correction already ensures flux conservation. Therefore this parameter should be TRUE (for response and science data) only if reduce.ffmethd = no.  (bool;  default:  False).  The
              full name of this option for the EsoRex configuration file is uves_cal_response.reduce.rebin.scale [default = False].

       --reduce.rebin.wavestep <float>
              The  bin size used for BLUE/REDL data (in w.l.u.) in wavelength space.  If negative, a step size of 2/3 * ( average pixel size ) is used.  (float; default: -1.0). The full name of this
              option for the EsoRex configuration file is uves_cal_response.reduce.rebin.wavestep [default = -1.0].

       --reduce.rebin.wavestep_redu <float>
              The bin size used for REDU data (in w.l.u.) in wavelength space. If negative, a step size of 2/3 * ( average pixel size ) is used. (float; default: -1.0). The full name of this  option
              for the EsoRex configuration file is uves_cal_response.reduce.rebin.wavestep_redu [default = -1.0].

       --reduce.skysub <bool>
              Do  sky-subtraction  (only applicable to linear and average extractions)? (bool; default: True). The full name of this option for the EsoRex configuration file is uves_cal_response.re‐
              duce.skysub [default = True].

       --reduce.slitlength <float>
              Extraction slit length (in pixels). If negative, the value inferred from the raw frame header is used (float; default: -1.0). The full name of this option for the EsoRex  configuration
              file is uves_cal_response.reduce.slitlength [default = -1.0].

       --reduce.tiltcorr <bool>
              If  enabled  (recommended),  the  provided dispersion solutions obtained at different slit positions are interpolated linearly at the actually measured position of the object/sky. Line
              tilt correction is currently not supported for 2d extraction, in which case the dispersion solution obtained at the middle of the slit is always used. (bool; default: True).  The  full
              name of this option for the EsoRex configuration file is uves_cal_response.reduce.tiltcorr [default = True].

       Note that it is possible to create a configuration file containing these options, along with suitable default values. Please refer to the details provided by the 'esorex --help' command.

SEE ALSO
       The full documentation for the uves pipeline can be downloaded as a PDF file using the following URL:

              ftp://ftp.eso.org/pub/dfs/pipelines/uves/uves-pipeline-manual-6.1.8.pdf

       An overview over the existing ESO pipelines can be found on the web page https://www.eso.org/sci/software/pipelines/.

       Basic documentation about the EsoRex program can be found at the esorex (1) man page.

       It is possible to call the pipelines from python using the python-cpl package.  See https://packages.python.org/python-cpl/index.html for further information.

       The  other recipes of the uves pipeline are flames_cal_mkmaster(7), flames_cal_orderpos(7), flames_cal_predict(7), flames_cal_prep_sff_ofpos(7), flames_cal_wavecal(7), flames_obs_redchain(7),
       flames_obs_scired(7), flames_utl_unpack(7), uves_cal_cd_align(7), uves_cal_mbias(7), uves_cal_mdark(7),  uves_cal_mflat(7),  uves_cal_mflat_combine(7),  uves_cal_mkmaster(7),  uves_cal_order‐
       pos(7), uves_cal_predict(7), uves_cal_tflat(7), uves_cal_wavecal(7), uves_obs_redchain(7), uves_obs_scired(7), uves_utl_ima_arith(7), uves_utl_remove_crh_single(7)

VERSION
       uves_cal_response 6.1.8

AUTHOR
       Jonas M. Larsen <cpl@eso.org>

BUG REPORTS
       Please report any problems to cpl@eso.org. Alternatively, you may send a report to the ESO User Support Department <usd-help@eso.org>.

LICENSE
       This file is part of the FLAMES/UVES Pipeline Copyright (C) 2004, 2005, 2006, 2007 European Southern Observatory

       This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the
       License, or (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
       GNU General Public License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation,  Inc.,  51  Franklin  St,  Fifth  Floor,  Boston,  MA
       02111-1307  USA

uves_cal_response                                                                                6.1.8                                                                            UVES_CAL_RESPONSE(7)
