DRBDMETA(8)                                                                                  System Administration                                                                                  DRBDMETA(8)

NAME
       drbdmeta - DRBD's meta data management tool

SYNOPSIS
       drbdmeta [--force] [--ignore-sanity-checks] {device} {v06 minor | v07 meta_dev index | v08 meta_dev index} {command} [cmd args...]

DESCRIPTION
       Drbdmeta is used to create, display and modify the contents of DRBD's meta data storage. Usually you do not want to use this command directly, but start it via the frontend drbdadm(8).

       This command only works if the DRBD resource is currently down, or at least detached from its backing storage. The first parameter is the device node associated to the resource. With the second
       parameter you can select the version of the meta data. Currently all major DRBD releases (0.6, 0.7 and 8) are supported.

OPTIONS
       --force

           All questions that get asked by drbdmeta are treated as if the user answered 'yes'.

       --ignore-sanity-checks

           Some sanity checks cause drbdmeta to terminate. E.g. if a file system image would get destroyed by creating the meta data. By using that option you can force drbdmeta to ignore these checks.

COMMANDS
       create-md --peer-max-bio-size val --al-stripes val --al-stripe-size-kB val

           Create-md initializes the meta data storage. This needs to be done before a DRBD resource can be taken online for the first time. In case there is already a meta data signature of an older format
           in place, drbdmeta will ask you if it should convert the older format to the selected format.

           If you will use the resource before it is connected to its peer for the first time DRBD may perform better if you use the --peer-max-bio-size option. For DRBD versions of the peer use up to these
           values: <8.3.7 -> 4k, 8.3.8 -> 32k, 8.3.9 -> 128k, 8.4.0 -> 1M.

           If you want to use more than 6433 activity log extents, or live on top of a spriped RAID, you may specify the number of stripes (--al-stripes, default 1), and the stripe size (--al-stripe-size-kB,
           default 32). To just use a larger linear on-disk ring-buffer, leave the number of stripes at 1, and increase the size only:

           drbdmeta 0 v08 /dev/vg23/lv42 internal create-md --al-stripe-size 1M

           To avoid a single "spindle" from becoming a bottleneck, increase the number of stripes, to achieve an interleaved layout of the on-disk activity-log transactions. What you give as "stripe-size"
           should be what is a.k.a. "chunk size" or "granularity" or "strip unit": the minimum skip to the next "spindle".

           drbdmeta 0 v08 /dev/vg23/lv42 internal create-md --al-stripes 7 --al-stripe-size 64k

       get-gi

           Get-gi shows a short textual representation of the data generation identifier. In version 0.6 and 0.7 these are generation counters, while in version 8 it is a set of UUIDs.

       show-gi

           Show-gi prints a textual representation of the data generation identifiers including explanatory information.

       dump-md

           Dumps the whole contents of the meta data storage including the stored bit-map and activity-log in a textual representation.

       outdate

           Sets the outdated flag in the meta data. This is used by the peer node when it wants to become primary, but cannot communicate with the DRBD stack on this host.

       dstate

           Prints the state of the data on the backing storage. The output is always followed by '/DUnknown' since drbdmeta only looks at the local meta data.

       check-resize

           Examines the device size of a backing device, and it's last known device size, recorded in a file /var/lib/drbd/drbd-minor-??.lkbd. In case the size of the backing device changed, and the meta
           data can be found at the old position, it moves the meta data to the right position at the end of the block device.

EXPERTS COMMANDS
       Drbdmeta allows you to modify the meta data as well. This is intentionally omitted for the command's usage output, since you should only use it if you really know what you are doing. By setting the
       generation identifiers to wrong values, you risk to overwrite your up-to-data data with an older version of your data.

       set-gi gi

           Set-gi allows you to set the generation identifier.  Gi needs to be a generation counter for the 0.6 and 0.7 format, and a UUID set for 8.x. Specify it in the same way as get-gi shows it.

       restore-md dump_file

           Reads the dump_file and writes it to the meta data.

VERSION
       This document was revised for version 8.3.2 of the DRBD distribution.

AUTHOR
       Written by Philipp Reisner <philipp.reisner@linbit.com> and Lars Ellenberg <lars.ellenberg@linbit.com>.

REPORTING BUGS
       Report bugs to <drbd-user@lists.linbit.com>.

COPYRIGHT
       Copyright 2001-2008 LINBIT Information Technologies, Philipp Reisner, Lars Ellenberg. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY
       or FITNESS FOR A PARTICULAR PURPOSE.

SEE ALSO
       drbdadm(8)

DRBD 8.4.11                                                                                       20 Mar 2020                                                                                       DRBDMETA(8)
