XSH_FLEXCOMP(7)                                                                              xshoo recipes                                                                             XSH_FLEXCOMP(7)

NAME
       xsh_flexcomp - Compute the flexure of the instrument

SYNOPSIS
       esorex xsh_flexcomp [OPTIONS] FILE.sof

DESCRIPTION
       This recipe computes the flexure of the instrument and correct CAL files.

         Input Frames :
           - [UVB, VIS] One RAW frame (Format = RAW, Tag = AFF_ATT_arm)
           - [NIR] Two RAW frames ((Format = RAW,  Tag = AFC_ATT_arm_ON,AFC_ATT_arm_OFF)
           - An arc line list (Format = TABLE, Tag = ARC_LINE_LIST_AFC_arm)
           - A spectral format table frame (Format = TABLE, Tag = SPECTRAL_FORMAT_TAB_arm)
           - [UVB,VIS] A master bias (Format = PRE, Tag = MASTER_BIAS_arm)
           - [UVB,VIS] A master dark (Format = PRE, Tag = MASTER_DARK_arm)
           - An order table frame (Format = TABLE, Tag = ORDER_TAB_EDGES_IFU_arm)
         - [OPTIONAL] A non-linear badpixel map (Tag = BP_MAP_NL_arm)
         - [OPTIONAL] A reference badpixel map (Tag = BP_MAP_RP_arm)
           - [poly mode]  A wave solution frame (Format = TABLE, Tag = WAVE_TAB_2D_arm)
           - [physical model mode] A model cfg table (Format = TABLE, Tag = XSH_MOD_CFG_OPT_2D_arm)
         Products :
           - [poly mode]  An updated wave solution frame (Format = TABLE, Tag = WAVE_TAB_AFC_arm)
           - [physical model mode] An updated  model cfg table (Format = TABLE, Tag = XSH_MOD_CFG_OPT_AFC_arm)
           - An updated order table frame (Format = TABLE, Tag = ORDER_TAB_AFC_IFU_arm)
           - [poly mode] A dispersion table frame (Format = TABLE, Tag =  DISP_TAB_AFC_arm)

OPTIONS
       --keep-temp <str>
              If ´no´, temporary files are deleted. (str; default: ´no´). The full name of this option for the EsoRex configuration file is xsh.xsh_flexcomp.keep-temp [default = no].

       --debug-level <str>
              Additional  xshooter  debug level. One of ´none´, ´low´, ´medium´, ´high´ (str; default: ´none´). The full name of this option for the EsoRex configuration file is xsh.xsh_flexcomp.de‐
              bug-level [default = none].

       --time-stamp <bool>
              Add timestamp to product file name. (bool; default: False). The full name of this option for the EsoRex configuration file is xsh.xsh_flexcomp.time-stamp [default = False].

       --decode-bp <int>
              Integer representation of the bits to be considered bad when decoding the bad pixel mask pixel values.   Most frequent codes relevant for the user:   0: good pixel,   8: pick-up noise,
              16: cosmic-ray removed,   32: cosmic-ray unremoved,   128: calibration file defect, 256: hot pixel,   512: dark pixel,   4096:  A/D  converted  saturation,  32768:  non  linear  pixel,
              1048576:  extrapolated  flux  in  NIR,  4194304:  Interpolated  flux  during  extraction.  (int; default: 2144337919). The full name of this option for the EsoRex configuration file is
              xsh.xsh_flexcomp.decode-bp [default = 2144337919].

       --pre-overscan-corr <int>
              pre-overscan correction. 0: no correction 1: mean overscan correction 2: mean prescan correction 3: (mean pre+mean overscan)/2 correction (int; default: 1). The full name of  this  op‐
              tion for the EsoRex configuration file is xsh.xsh_flexcomp.pre-overscan-corr [default = 1].

       --detectarclines-fit-win-hsize <int>
              Half  window  size  (HWS)  in  pixels  for the line 2D fitting window (total window size = 2*HWS+1) (int; default: 6). The full name of this option for the EsoRex configuration file is
              xsh.xsh_flexcomp.detectarclines-fit-win-hsize [default = 6].

       --detectarclines-search-win-hsize <int>
              Half window size (HWS) in pixels for the line search box around the expected position (total window size = 2*HWS+1) [bin units] (int; default: 3). The full name of this option for  the
              EsoRex configuration file is xsh.xsh_flexcomp.detectarclines-search-win-hsize [default = 3].

       --detectarclines-running-median-hsize <int>
              Half  window  size  in pixels (HWS) for the running median box (int; default: 0). The full name of this option for the EsoRex configuration file is xsh.xsh_flexcomp.detectarclines-run‐
              ning-median-hsize [default = 0].

       --detectarclines-wavesol-deg-lambda <int>
              Degree in lambda in the polynomial solution X=f(lambda,order,slit) and Y=f(lambda,order,slit) (POLY mode) (int; default: 5). The full name of this option for the  EsoRex  configuration
              file is xsh.xsh_flexcomp.detectarclines-wavesol-deg-lambda [default = 5].

       --detectarclines-wavesol-deg-order <int>
              Degree  in  order  in the polynomial solution X=f(lambda,order,slit) and Y=f(lambda,order,slit) (POLY mode) (int; default: 5). The full name of this option for the EsoRex configuration
              file is xsh.xsh_flexcomp.detectarclines-wavesol-deg-order [default = 5].

       --detectarclines-min-sn <float>
              Minimum signal-to-noise ratio to filter lines [xsh_predict: UVB,VIS=5,NIR=4; xsh_2dmap: UVB=3, VIS=6, NIR=10] (float; default: 5.0). The full name of this option for the EsoRex config‐
              uration file is xsh.xsh_flexcomp.detectarclines-min-sn [default = 5.0].

       --detectarclines-find-lines-center <str>
              Method used to find the center of the lines: gaussian, barycenter.  Gaussian method applies a Gaussian fit to the line. Barycenter method computes the  line  centroid.  (str;  default:
              ´gaussian´). The full name of this option for the EsoRex configuration file is xsh.xsh_flexcomp.detectarclines-find-lines-center [default = gaussian].

       --detectarclines-clip-sigma <float>
              Kappa  value  in  sigma  clipping  during the polynomial solution fit (POLY mode) (float; default: 2.0). The full name of this option for the EsoRex configuration file is xsh.xsh_flex‐
              comp.detectarclines-clip-sigma [default = 2.0].

       --detectarclines-clip-niter <int>
              Number of iterations in sigma clipping during the polynomial solution fit (POLY mode) (int; default:  10).  The  full  name  of  this  option  for  the  EsoRex  configuration  file  is
              xsh.xsh_flexcomp.detectarclines-clip-niter [default = 10].

       --detectarclines-clip-frac <float>
              Minimal  fractions of bad pixel allowed in sigma clipping duringthe polynomial solution fit (POLY mode) (float; default: 0.7). The full name of this option for the EsoRex configuration
              file is xsh.xsh_flexcomp.detectarclines-clip-frac [default = 0.7].

       --dispersol-deg-x <int>
              Degree in X in the polynomial dispersion solution lambda=f(X,Y) and slit=f(X,Y) (int; default: 4). The full name of this option for  the  EsoRex  configuration  file  is  xsh.xsh_flex‐
              comp.dispersol-deg-x [default = 4].

       --dispersol-deg-y <int>
              Degree  in  Y  in  the  polynomial  dispersion solution lambda=f(X,Y) and slit=f(X,Y) (int; default: 5). The full name of this option for the EsoRex configuration file is xsh.xsh_flex‐
              comp.dispersol-deg-y [default = 5].

       --model-maxit <int>
              Number/10 of annealing iterations if in physical model mode. (int; default: 1000). The full name of this option for the EsoRex configuration file is  xsh.xsh_flexcomp.model-maxit  [de‐
              fault = 1000].

       --model-anneal-factor <float>
              Multiplier  applied to the automatic parameter ranges (i.e. when scenario!=0). For routine operations should be 1.0. (physical model mode). (float; default: 1.0). The full name of this
              option for the EsoRex configuration file is xsh.xsh_flexcomp.model-anneal-factor [default = 1.0].

       --model-scenario <int>
              selects preset flag and range combinations appropriate to common scenarios: -1 - Only the position across the slit and     camera focal length are open  0  -  No  scenario,  input  cfg
              flags  and limits     used.  1 - scenario appropriate for the startup     recipe (large ranges for parameters      affecting single ph exposures, dist      coeff fixed) 2 - Like 1, but
              includes parameters      affecting all ph positions 3 - Scenario for use in fine tuning cfg     to match routine wavecal exposures. All     parameters affecting 1ph  exposures      ex‐
              cept dist coeffs are included and     parameter ranges are small. (For use by flexcomp in 1ph case). 4 - Like 3 but includes parameters affecting all ph positions (Standard for     use
              by flexcomp in 9ph case and 2dmap). 5 - Like 4 but includes also dist coeffs 6 - Just dist coeffs (and chipx, chipy) (int; default: 3). The full name of this option for the EsoRex con‐
              figuration file is xsh.xsh_flexcomp.model-scenario [default = 3].

       Note that it is possible to create a configuration file containing these options, along with suitable default values. Please refer to the details provided by the 'esorex --help' command.

SEE ALSO
       The full documentation for the xshoo pipeline can be downloaded as a PDF file using the following URL:

              ftp://ftp.eso.org/pub/dfs/pipelines/xshoo/xshoo-pipeline-manual-12.1.pdf

       An overview over the existing ESO pipelines can be found on the web page https://www.eso.org/sci/software/pipelines/.

       Basic documentation about the EsoRex program can be found at the esorex (1) man page.

       It is possible to call the pipelines from python using the python-cpl package.  See https://packages.python.org/python-cpl/index.html for further information.

       The  other  recipes  of  the  xshoo  pipeline are xsh_2dmap(7), xsh_cfg_recover(7), xsh_geom_ifu(7), xsh_lingain(7), xsh_mbias(7), xsh_mdark(7), xsh_mflat(7), xsh_orderpos(7), xsh_predict(7),
       xsh_respon_slit_nod(7), xsh_respon_slit_offset(7),  xsh_respon_slit_stare(7),  xsh_scired_ifu_offset(7),  xsh_scired_ifu_offset_drl(7),  xsh_scired_ifu_stare(7),  xsh_scired_ifu_stare_drl(7),
       xsh_scired_slit_nod(7), xsh_scired_slit_offset(7), xsh_scired_slit_stare(7), xsh_util_physmod(7), xsh_wavecal(7)

VERSION
       xsh_flexcomp 3.5.3

AUTHOR
       P.Goldoni, L.Guglielmi, R. Haigron, F. Royer <amodigli@eso.org>

BUG REPORTS
       Please report any problems to amodigli@eso.org. Alternatively, you may send a report to the ESO User Support Department <usd-help@eso.org>.

LICENSE
       This file is part of the X-shooter Instrument Pipeline Copyright (C) 2006 European Southern Observatory

       This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the
       License, or (at your option) any later version.

       This  program  is  distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
       GNU General Public License for more details.

       You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software  Foundation,  Inc.,  59  Temple  Place,  Suite  330,  Boston,  MA
       02111-1307  USA

xsh_flexcomp                                                                                     3.5.3                                                                                 XSH_FLEXCOMP(7)
