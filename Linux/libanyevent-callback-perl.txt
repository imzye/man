AnyEvent::Callback(3pm)                                                             User Contributed Perl Documentation                                                             AnyEvent::Callback(3pm)

NAME
       AnyEvent::Callback - callback aggregator for AnyEvent watchers.

SYNOPSIS
           use AnyEvent::Callback;

           # usually watchers are looked as:
           AE::something @args, sub { ... };
           AE::something
               @args,
               sub { ... },    # result
               sub { ... };    # error

           use AnyEvent::Callback;

           AE::something @args, CB { ... };
           AE::something @args,
               CB sub { ... },     # result
                   sub { ... };    # error

           AE::something @args,
               CB sub { ... },     # result
                   sub { ... },    # error
                   sub { ... };    # anyway callback

       Callback hierarchy

           my $cbchild = $cb->CB(sub { ... });

           ...

           $cbchild->error('error'); # will call $cb->error('error');

       Inside Your callback You can:

           sub my_watcher {
               my $cb = pop;
               my @args = @_;

               # ...

               $cb->error( @error );   # error callback will be called
               # or:
               $cb->( $value );        # result callback will be called
           }

       Callbacks stack

           my $cbs = CBS;

           for (1 .. $n) {
               AE::something @args, $cbs->cb;
           }

           $cbs->wait(sub {
               for (@_) {
                   if ($_->is_error) {     # handle one error
                       my @err = $_->errors; # or:
                       my $errstr = $_->errstr;
                   } else {                # results
                       my @res = $_->results;
                   }
               }

           });

DESCRIPTION
       The module allows You to create callback's hierarchy. Also the module groups error and result callbacks into one object.

       Also the module checks if one callback was called by watcher or not.  If a watcher doesn't call result or error callback, error callback will be called automatically.

       Also the module checks if a callback was called reentrant. In the case the module will complain (using "carp" in Carp).

       If a watcher touches error callback and if superior didn't define error callback, the module will call error callback upwards hierarchy. Example:

           AE::something @args, CB \&my_watcher, \&on_error;

           sub on_error {

           }

           sub my_watcher {
               my $cb = pop;

               ...

               the_other_watcher $cb->CB( sub { # error callback wasn't defined
                   my $cb = pop;
                   ...
                   yet_another_watcher1 $cb->CB( sub {
                       my $cb = pop;
                       ...
                       $cb->( 123 );   # upwards callback

                   });
                   yet_another_watcher2 $cb->CB( sub {
                       my $cb = pop;
                       ...

                       $cb->error( 456 );  # on_error will be called

                   });
               });
           }

METHODS
   'CODE' (overloaded fake method)
           $cb->( ... );

       You can use the object as usually CODEREF.

   CB
       Creates new callback object that have binding on parent callback.

           my $new_cb = $cb->CB(sub { ... });   # the cb doesn't catch errors

           my $new_cb = CB(sub { ... }, sub { ... }); # the cb catches errors

           my $new_cb = $cb->CB(sub { ... }, sub { ... }); # the same

   error
       Calls error callback. If the object has no registered error callbacks, parent object's error callback will be called.

           $cb->error('WTF?');

COPYRIGHT AND LICENCE
        Copyright (C) 2012 by Dmitry E. Oboukhov

       This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.

perl v5.40.1                                                                                     2025-06-18                                                                         AnyEvent::Callback(3pm)
